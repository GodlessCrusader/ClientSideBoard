@inject IJSRuntime _jsRuntime
@inject HttpClient _httpClient
@inject ServerApiCaller _apiCaller

<InputFile OnChange="UploadImageAsync">Upload Image</InputFile>
<span class="alert-danger">@_spanText</span>
<button class="btn-primary" @onclick="SendToServerAsync">Submit</button>

@code {
    private string _spanText = string.Empty;
    private List<IBrowserFile> _mediaFiles;

    protected override void OnInitialized()
    {
        //   User = _dbContext.Users.Where(x => x.Id == UserId).Single();
        // User.Medias = _dbContext.Media.Where(x => x.OwnerId == UserId).ToList();
    }
    public async Task UploadImageAsync(InputFileChangeEventArgs args)
    {
        _mediaFiles = args.GetMultipleFiles().ToList();

    }

    public async Task SendToServerAsync()
    {

        foreach (var media in _mediaFiles)
        {
            var response = await _apiCaller.UploadMediaAsync(media);
            if (!response.IsSuccessStatusCode)
                _spanText = "Uploading error";
        }
        
    }
}
